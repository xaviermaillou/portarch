{"ast":null,"code":"var _jsxFileName = \"/Users/xavier/Documents/De\\u0301veloppement/portarch/src/App.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport Panneau from './components/panneau';\nimport Menu from './components/menu';\nimport firebase from './firebase';\nimport Hamburger from './components/hamburger';\n\nfunction Useœuvres() {\n  const [œuvres, setœuvres] = useState([]);\n  useEffect(() => {\n    firebase.firestore().collection('œuvres').onSnapshot(snapshot => {\n      const newœuvres = snapshot.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data(),\n        photos: []\n      }));\n      setœuvres(newœuvres);\n    });\n  }, []);\n  return œuvres;\n}\n\nfunction usePhotos() {\n  const [photos, setPhotos] = useState([]);\n  useEffect(() => {\n    firebase.firestore().collection('photos').onSnapshot(snapshot => {\n      const newPhotos = snapshot.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      setPhotos(newPhotos);\n    });\n  }, []);\n  return photos;\n}\n\nfunction UseMesœuvres() {\n  const [mesœuvres, setMesœuvres] = useState([]);\n  useEffect(() => {\n    firebase.auth().onAuthStateChanged(function (user) {\n      if (user) {\n        firebase.firestore().collection('œuvres').where('auteurID', '==', user.uid).onSnapshot(snapshot => {\n          const newMesœuvres = snapshot.docs.map(doc => ({\n            id: doc.id,\n            ...doc.data()\n          }));\n          setMesœuvres(newMesœuvres);\n        });\n      } else {\n        return;\n      }\n    });\n  }, []);\n  return mesœuvres;\n}\n\nconst App = () => {\n  const [refresh, setRefresh] = useState(false);\n  const [auth, setAuth] = useState(false);\n  const [username, setUsername] = useState();\n  const [profilePicture, setProfilePicture] = useState();\n  const œuvres = Useœuvres();\n  const photos = usePhotos();\n  const mesœuvres = UseMesœuvres();\n  const [margin, setMargin] = useState('0px');\n  useEffect(() => {\n    if (window.innerWidth <= 600) {\n      setMargin((window.innerHeight - window.innerWidth) / 2 + 'px');\n    }\n  }, []);\n  console.log('Refresh : ' + refresh);\n  œuvres.forEach(œuvre => {\n    photos.forEach(photo => {\n      if (photo.œuvre === œuvre.id && !Object.values(œuvre.photos).includes(photo.url)) {\n        œuvre.photos.push(photo.url);\n      }\n    });\n  });\n  useEffect(() => {\n    firebase.auth().onAuthStateChanged(function (user) {\n      if (user) {\n        // User is signed in.\n        setAuth(true);\n        setUsername(user.displayName);\n        user.photoURL ? setProfilePicture(user.photoURL) : setProfilePicture('https://firebasestorage.googleapis.com/v0/b/portarch-4f70e.appspot.com/o/icônes%2Fprofil2.png?alt=media&token=0f86a5d5-f039-42af-89fc-4f915f10a3d5');\n      } else {\n        // User is signed out.\n        setAuth(false);\n      }\n    });\n  }, []);\n\n  const reload = () => {\n    window.location.reload(true);\n  };\n  /* useEffect(() => {\n      œuvres.forEach((œuvre: any) => {\n          photos.forEach((photo: any) => {\n              if(photo.œuvre === œuvre.id) {\n                  œuvre.photos.push(photo.url);\n              }\n          })\n      });\n  }, [œuvres, photos]); */\n\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    onClick: reload,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }\n  }, \"PORTARCH\"), /*#__PURE__*/React.createElement(Hamburger, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Menu, {\n    setRefresh: setRefresh,\n    mesœuvres: mesœuvres,\n    auth: auth,\n    username: username,\n    setUsername: setUsername,\n    profilePicture: profilePicture,\n    setProfilePicture: setProfilePicture,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"panneauContainer\",\n    style: {\n      paddingTop: `{margin}`\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }\n  }, œuvres.map(œuvre => /*#__PURE__*/React.createElement(Panneau, {\n    key: œuvre.id,\n    titre: œuvre.titre,\n    auteur: œuvre.auteur,\n    photoAuteur: œuvre.photoAuteur,\n    photo: œuvre.photo,\n    photos: œuvre.photos,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 37\n    }\n  }))));\n};\n\nexport default App;","map":{"version":3,"sources":["/Users/xavier/Documents/Développement/portarch/src/App.tsx"],"names":["React","useState","useEffect","Panneau","Menu","firebase","Hamburger","Useœuvres","œuvres","setœuvres","firestore","collection","onSnapshot","snapshot","newœuvres","docs","map","doc","id","data","photos","usePhotos","setPhotos","newPhotos","UseMesœuvres","mesœuvres","setMesœuvres","auth","onAuthStateChanged","user","where","uid","newMesœuvres","App","refresh","setRefresh","setAuth","username","setUsername","profilePicture","setProfilePicture","margin","setMargin","window","innerWidth","innerHeight","console","log","forEach","œuvre","photo","Object","values","includes","url","push","displayName","photoURL","reload","location","paddingTop","titre","auteur","photoAuteur"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Panneau from './components/panneau'\nimport Menu from './components/menu';\nimport firebase from './firebase';\nimport Hamburger from './components/hamburger';\n\nfunction Useœuvres() {\n    const [œuvres, setœuvres] = useState<any>([]);\n\n    useEffect(() => {\n        firebase.firestore().collection('œuvres').onSnapshot((snapshot) => {\n            const newœuvres = snapshot.docs.map((doc) => ({\n                id: doc.id,\n                ...doc.data(),\n                photos: [] as any\n            }));\n    \n            setœuvres(newœuvres);\n        });\n    }, []);\n\n    return œuvres;\n}\n\nfunction usePhotos() {\n    const [photos, setPhotos] = useState<any>([]);\n\n    useEffect(() => {\n        firebase.firestore().collection('photos').onSnapshot((snapshot) => {\n            const newPhotos = snapshot.docs.map((doc) => ({\n                id: doc.id,\n                ...doc.data()\n            }));\n\n            setPhotos(newPhotos);\n        });\n    }, []);\n\n    return photos;\n}\n\nfunction UseMesœuvres() {\n    const [mesœuvres, setMesœuvres] = useState<any>([]);\n\n    useEffect(() => {\n        firebase.auth().onAuthStateChanged(function(user) {\n            if (user) {\n                firebase.firestore().collection('œuvres').where('auteurID', '==', user.uid).onSnapshot((snapshot) => {\n                    const newMesœuvres = snapshot.docs.map((doc) => ({\n                        id: doc.id,\n                        ...doc.data()\n                    }));\n\n                    setMesœuvres(newMesœuvres);\n                });\n            } else {\n            return;\n            }\n        });\n    }, []);\n\n    return mesœuvres;\n}\n  \nconst App: React.FC = () => {\n\n    const [refresh, setRefresh] = useState<boolean>(false);\n    const [auth, setAuth] = useState<boolean>(false);\n    const [username, setUsername] = useState<string|null|undefined>();\n    const [profilePicture, setProfilePicture] = useState<string|null|undefined>();\n    const œuvres = Useœuvres();\n    const photos = usePhotos();\n    const mesœuvres = UseMesœuvres();\n    const [margin, setMargin] = useState<string>('0px');\n\n    useEffect(() => {\n        if(window.innerWidth <= 600) {\n            setMargin((window.innerHeight - window.innerWidth) / 2 + 'px');     \n        }\n    }, []);\n\n    console.log('Refresh : ' + refresh);\n\n    œuvres.forEach((œuvre: any) => {\n        photos.forEach((photo: any) => {\n            if(photo.œuvre === œuvre.id && !Object.values(œuvre.photos).includes(photo.url)) {\n                œuvre.photos.push(photo.url);\n            }\n        })\n    });\n\n    useEffect(() => {\n        firebase.auth().onAuthStateChanged(function(user) {\n            if (user) {\n              // User is signed in.\n              setAuth(true);\n              setUsername(user.displayName);\n              user.photoURL ? setProfilePicture(user.photoURL) : setProfilePicture('https://firebasestorage.googleapis.com/v0/b/portarch-4f70e.appspot.com/o/icônes%2Fprofil2.png?alt=media&token=0f86a5d5-f039-42af-89fc-4f915f10a3d5');\n            } else {\n              // User is signed out.\n              setAuth(false)\n            }\n        });\n    }, []);\n\n    const reload = () => {\n        window.location.reload(true);\n    }\n\n    /* useEffect(() => {\n        œuvres.forEach((œuvre: any) => {\n            photos.forEach((photo: any) => {\n                if(photo.œuvre === œuvre.id) {\n                    œuvre.photos.push(photo.url);\n                }\n            })\n        });\n    }, [œuvres, photos]); */\n    \n return (\n  <div>\n      <h1 onClick={reload}>PORTARCH</h1>\n      <Hamburger />\n      <Menu \n        setRefresh={setRefresh}\n        mesœuvres={mesœuvres} \n        auth={auth} \n        username={username} \n        setUsername={setUsername} \n        profilePicture={profilePicture} \n        setProfilePicture={setProfilePicture} \n      />\n      <div className=\"panneauContainer\" style={{paddingTop: `{margin}`}}>\n        {œuvres.map((œuvre: any) => <Panneau key={œuvre.id} titre={œuvre.titre} auteur={œuvre.auteur} photoAuteur={œuvre.photoAuteur} photo={œuvre.photo} photos={œuvre.photos} />)}\n      </div>\n  </div>\n )\n}\n  \nexport default App;"]},"metadata":{},"sourceType":"module"}