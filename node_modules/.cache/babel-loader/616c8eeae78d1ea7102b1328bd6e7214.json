{"ast":null,"code":"var _jsxFileName = \"/Users/xavier/Documents/De\\u0301veloppement/portarch/src/components/cachet.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport './css/cachet.css';\nimport firebase from 'firebase/app';\nimport 'firebase/auth';\nimport 'firebase/firestore';\n\nconst Cachet = ({\n  refresh,\n  setRefresh,\n  auth,\n  id,\n  titre,\n  isFavori\n}) => {\n  var _firebase$auth$curren;\n\n  const userID = (_firebase$auth$curren = firebase.auth().currentUser) === null || _firebase$auth$curren === void 0 ? void 0 : _firebase$auth$curren.uid;\n  const [note, setNote] = useState(0);\n  useEffect(() => {\n    firebase.firestore().collection('œuvres').doc(id).onSnapshot(snapshot => {\n      var _snapshot$data;\n\n      setNote((_snapshot$data = snapshot.data()) === null || _snapshot$data === void 0 ? void 0 : _snapshot$data.note);\n    });\n  }, [id, isFavori]);\n\n  const addFavorite = () => {\n    if (isFavori) {\n      firebase.firestore().collection('favoris').doc(userID + id).delete();\n      setRefresh(!refresh);\n      console.log('Favori supprimé !');\n      firebase.firestore().collection('œuvres').doc(id).update({\n        note: note - 1\n      });\n      return;\n    } else if (!isFavori) {\n      firebase.firestore().collection('favoris').doc(userID + id).set({\n        favori: id,\n        utilisateur: userID\n      });\n      setRefresh(!refresh);\n      console.log('Favori ajouté !');\n      firebase.firestore().collection('œuvres').doc(id).update({\n        note: note + 1\n      });\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cachetContainer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 17\n    }\n  }, titre)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"star\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: id + \"Star\",\n    style: {\n      opacity: isFavori ? '1' : '0.25',\n      display: auth ? 'inline-block' : 'none'\n    },\n    className: \"starIMG\",\n    onClick: addFavorite,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 35\n    }\n  })));\n};\n\nexport default Cachet;","map":{"version":3,"sources":["/Users/xavier/Documents/Développement/portarch/src/components/cachet.tsx"],"names":["React","useState","useEffect","firebase","Cachet","refresh","setRefresh","auth","id","titre","isFavori","userID","currentUser","uid","note","setNote","firestore","collection","doc","onSnapshot","snapshot","data","addFavorite","delete","console","log","update","set","favori","utilisateur","opacity","display"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './css/cachet.css';\nimport firebase from 'firebase/app';\nimport 'firebase/auth';\nimport 'firebase/firestore';\n\ntype Props = {\n    refresh: boolean,\n    setRefresh: any,\n    auth: boolean,\n    id: string,\n    titre: string,\n    isFavori: boolean\n}\n\nconst Cachet: React.FC<Props> = ({ refresh, setRefresh, auth, id, titre, isFavori }) => {\n\n    const userID = firebase.auth().currentUser?.uid;\n    const [note, setNote] = useState<number>(0);\n\n    useEffect(() => {\n        firebase.firestore().collection('œuvres').doc(id).onSnapshot((snapshot) => {\n            setNote(snapshot.data()?.note);\n        });\n    }, [id, isFavori]);\n\n    const addFavorite = () => {\n        if(isFavori) {\n            firebase.firestore().collection('favoris').doc(userID+id).delete();\n            setRefresh(!refresh);\n            console.log('Favori supprimé !');\n            firebase.firestore().collection('œuvres').doc(id).update({\n                note: note-1\n            });\n            return;\n        } else if(!isFavori) {\n            firebase.firestore().collection('favoris').doc(userID+id).set({\n                favori: id,\n                utilisateur: userID\n            });\n            setRefresh(!refresh);\n            console.log('Favori ajouté !');\n            firebase.firestore().collection('œuvres').doc(id).update({\n                note: note+1\n            });\n        }\n    }\n\n    return (\n        <div className=\"cachetContainer\">\n            <div className=\"info\">\n                <h3>{titre}</h3>\n            </div>\n            <div className=\"star\"><div id={id + \"Star\"} style={{opacity: isFavori ? '1' : '0.25', display: auth ? 'inline-block' : 'none'}} className=\"starIMG\" onClick={addFavorite}></div></div>\n        </div>\n    );\n}\n\nexport default Cachet;"]},"metadata":{},"sourceType":"module"}