{"ast":null,"code":"var _jsxFileName = \"/Users/xavier/Documents/De\\u0301veloppement/portarch/src/components/config.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport firebase from '../firebase'; // import tinify from '../tinify';\n\nconst Config = ({\n  userID,\n  username,\n  setUsername,\n  profilePicture,\n  setProfilePicture,\n  uni,\n  setUni,\n  pays,\n  setPays\n}) => {\n  const [name, setName] = useState('');\n  const [newUni, setNewUni] = useState('');\n  const [newPays, setNewPays] = useState('');\n  const [editName, setEditName] = useState(false);\n  const [editUni, setEditUni] = useState(false);\n  const [editPays, setEditPays] = useState(false);\n  const [errorMsg, setErrorMsg] = useState('Elegí un nombre');\n  const [errorMsgImg, setErrorMsgImg] = useState();\n  const [errorMsgUni, setErrorMsgUni] = useState('Elegí tu universidad');\n  const [errorMsgPays, setErrorMsgPays] = useState('Elegí tu país');\n  useEffect(() => {\n    if (username) {\n      setName(username);\n    }\n\n    if (uni) {\n      setNewUni(uni);\n    }\n\n    if (pays) {\n      setNewPays(pays);\n    }\n  }, [username, uni, pays]);\n  useEffect(() => {\n    const profilePictureDiv = document.getElementsByClassName('profilePictureGrand')[0];\n    setTimeout(function () {\n      let width = document.getElementsByClassName('lateral')[0].clientWidth;\n      profilePictureDiv.style.height = width + \"px\";\n      profilePictureDiv.style.width = width + \"px\";\n    }, 500);\n  }, []);\n\n  const signOut = () => {\n    firebase.auth().signOut();\n    window.location.reload(true);\n  };\n\n  const handleChangeName = e => {\n    setName(e.target.value);\n  };\n\n  const handleChangeUni = e => {\n    setNewUni(e.target.value);\n  };\n\n  const handleSubmitUni = e => {\n    e.preventDefault();\n\n    if (newUni.length < 2) {\n      setNewUni('');\n      setErrorMsgUni('No existe !');\n      setTimeout(function () {\n        setErrorMsgUni('Elegí tu universidad');\n      }, 3000);\n      return;\n    }\n\n    var user = firebase.auth().currentUser;\n\n    if (user) {\n      firebase.firestore().collection('config').doc(user.uid).update({\n        uni: newUni\n      });\n      setEditUni(false);\n      setUni(newUni);\n    } else {\n      return;\n    }\n  };\n\n  const handleChangePays = e => {\n    setNewPays(e.target.value);\n  };\n\n  const handleSubmitPays = e => {\n    e.preventDefault();\n\n    if (newPays.length < 2) {\n      setNewPays('');\n      setErrorMsgPays('No existe ese país !');\n      setTimeout(function () {\n        setErrorMsgPays('Elegí tu país');\n      }, 3000);\n      return;\n    }\n\n    var user = firebase.auth().currentUser;\n\n    if (user) {\n      firebase.firestore().collection('config').doc(user.uid).update({\n        pays: newPays\n      });\n      setEditPays(false);\n      setPays(newPays);\n    } else {\n      return;\n    }\n  };\n\n  const handleSubmitName = e => {\n    e.preventDefault();\n\n    if (name.length < 2) {\n      setName('');\n      setErrorMsg('Debe tener al menos 2 carácteres !');\n      setTimeout(function () {\n        setErrorMsg('Elegí un nombre');\n      }, 3000);\n      return;\n    }\n\n    firebase.firestore().collection('config').doc(userID).set({\n      username: name\n    });\n    setEditName(false);\n    setUsername(name);\n  };\n\n  const handleEditPhoto = () => {\n    document.getElementsByName('photo')[0].click();\n  };\n\n  const handleChangePhoto = e => {\n    var user = firebase.auth().currentUser;\n    setErrorMsgImg(undefined);\n\n    if (e.target.files && user) {\n      var file = e.target.files[0];\n\n      if (file.type !== 'image/jpeg' && file.type !== 'image/png') {\n        setErrorMsgImg('Debe ser JPG o PNG !');\n        return;\n      } // tinify.fromFile(\"unoptimized.jpg\").toFile(\"optimized.jpg\"); \n\n\n      var ref = firebase.storage().ref().child('profilePicture/' + user.uid);\n      console.log(ref);\n      ref.put(file).then(function (result) {\n        ref.getDownloadURL().then(url => {\n          user === null || user === void 0 ? void 0 : user.updateProfile({\n            photoURL: url\n          });\n          setProfilePicture(url);\n        });\n      });\n      /* ref.getDownloadURL().then((url) => {\n          user?.updateProfile({\n              photoURL: url\n          });\n          task.on('state_changed', function(snapshot) {\n              var percentage = (snapshot.bytesTransferred / snapshot.totalBytes) *100;\n              if (percentage === 100) {console.log(url);setProfilePicture(url);}\n          });\n      }); */\n    } else {\n      return;\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"configContainer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 9\n    }\n  }, (username === null || editName === true) && /*#__PURE__*/React.createElement(\"form\", {\n    className: \"signupForm\",\n    onSubmit: e => {\n      handleSubmitName(e);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    name: \"username\",\n    type: \"text\",\n    autoComplete: \"off\",\n    className: \"editNameInput\",\n    placeholder: errorMsg,\n    value: name,\n    onChange: e => {\n      handleChangeName(e);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 21\n    }\n  })), username !== null && editName === false && /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"username\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 17\n    }\n  }, username, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"edit\",\n    onClick: () => setEditName(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 52\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"profilePictureGrand\",\n    style: {\n      backgroundImage: `url(${profilePicture})`\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 17\n    }\n  }, errorMsgImg), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"edit\",\n    onClick: handleEditPhoto,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 17\n    }\n  }, \"EDITAR\")), /*#__PURE__*/React.createElement(\"form\", {\n    className: \"signupForm\",\n    style: {\n      display: 'none'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    name: \"photo\",\n    type: \"file\",\n    onChange: e => {\n      handleChangePhoto(e);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 17\n    }\n  })), (uni === null || editUni === true) && /*#__PURE__*/React.createElement(\"form\", {\n    className: \"signupForm\",\n    onSubmit: e => {\n      handleSubmitUni(e);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    name: \"uni\",\n    type: \"text\",\n    autoComplete: \"off\",\n    className: \"editNameInput\",\n    placeholder: errorMsgUni,\n    value: newUni,\n    onChange: e => {\n      handleChangeUni(e);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 21\n    }\n  })), uni !== null && editUni === false && /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"username\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 17\n    }\n  }, uni, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"edit\",\n    onClick: () => setEditUni(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 47\n    }\n  })), (pays === null || editPays === true) && /*#__PURE__*/React.createElement(\"form\", {\n    className: \"signupForm\",\n    onSubmit: e => {\n      handleSubmitPays(e);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    name: \"pays\",\n    type: \"text\",\n    autoComplete: \"off\",\n    className: \"editNameInput\",\n    placeholder: errorMsgPays,\n    value: newPays,\n    onChange: e => {\n      handleChangePays(e);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 21\n    }\n  })), pays !== null && editPays === false && /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"username\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 17\n    }\n  }, pays, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"edit\",\n    onClick: () => setEditPays(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 48\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: signOut,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 13\n    }\n  }, \"Desconectarse\"));\n};\n\nexport default Config;","map":{"version":3,"sources":["/Users/xavier/Documents/Développement/portarch/src/components/config.tsx"],"names":["React","useState","useEffect","firebase","Config","userID","username","setUsername","profilePicture","setProfilePicture","uni","setUni","pays","setPays","name","setName","newUni","setNewUni","newPays","setNewPays","editName","setEditName","editUni","setEditUni","editPays","setEditPays","errorMsg","setErrorMsg","errorMsgImg","setErrorMsgImg","errorMsgUni","setErrorMsgUni","errorMsgPays","setErrorMsgPays","profilePictureDiv","document","getElementsByClassName","setTimeout","width","clientWidth","style","height","signOut","auth","window","location","reload","handleChangeName","e","target","value","handleChangeUni","handleSubmitUni","preventDefault","length","user","currentUser","firestore","collection","doc","uid","update","handleChangePays","handleSubmitPays","handleSubmitName","set","handleEditPhoto","getElementsByName","click","handleChangePhoto","undefined","files","file","type","ref","storage","child","console","log","put","then","result","getDownloadURL","url","updateProfile","photoURL","backgroundImage","display"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport firebase from '../firebase';\n// import tinify from '../tinify';\n\ntype Props = {\n    userID: string,\n    username: string|null|undefined,\n    profilePicture: string|null|undefined,\n    setUsername: any,\n    setProfilePicture: any,\n    uni: string|null|undefined,\n    setUni: any,\n    pays: string|null|undefined,\n    setPays: any\n}\n\nconst Config: React.FC<Props> = ({ userID, username, setUsername, profilePicture, setProfilePicture, uni, setUni, pays, setPays }) => {\n    const [name, setName] = useState<string>('');\n    const [newUni, setNewUni] = useState<string>('');\n    const [newPays, setNewPays] = useState<string>('');\n    const [editName, setEditName] = useState<boolean>(false);\n    const [editUni, setEditUni] = useState<boolean>(false);\n    const [editPays, setEditPays] = useState<boolean>(false);\n    const [errorMsg, setErrorMsg] = useState<string>('Elegí un nombre');\n    const [errorMsgImg, setErrorMsgImg] = useState<string|undefined>();\n    const [errorMsgUni, setErrorMsgUni] = useState<string|undefined>('Elegí tu universidad');\n    const [errorMsgPays, setErrorMsgPays] = useState<string|undefined>('Elegí tu país');\n\n    useEffect(() => {\n        if (username) {setName(username)}\n        if (uni) {setNewUni(uni)}\n        if (pays) {setNewPays(pays)}\n    }, [username, uni, pays]);\n\n    useEffect(() => {\n        const profilePictureDiv = document.getElementsByClassName('profilePictureGrand')[0] as HTMLElement;\n        setTimeout(function(){ \n            let width = document.getElementsByClassName('lateral')[0].clientWidth;\n            profilePictureDiv.style.height = width + \"px\";\n            profilePictureDiv.style.width = width + \"px\";  \n        }, 500);       \n    }, []);\n\n    const signOut = () => {\n        firebase.auth().signOut();\n        window.location.reload(true);\n    }\n\n    const handleChangeName = (e: React.ChangeEvent<HTMLInputElement>) => {\n        setName(e.target.value);\n    }\n\n    const handleChangeUni = (e: React.ChangeEvent<HTMLInputElement>) => {\n        setNewUni(e.target.value);\n    }\n\n    const handleSubmitUni = (e: React.FormEvent<HTMLFormElement>) => {\n        e.preventDefault();\n        if(newUni.length < 2) {\n            setNewUni('');\n            setErrorMsgUni('No existe !');\n            setTimeout(function(){ setErrorMsgUni('Elegí tu universidad'); }, 3000);\n            return;\n        }\n        var user = firebase.auth().currentUser;\n        if (user) {\n            firebase.firestore().collection('config').doc(user.uid).update({\n                uni: newUni\n            });\n            setEditUni(false);\n            setUni(newUni);\n        } else {\n            return;\n        }\n    }\n\n    const handleChangePays = (e: React.ChangeEvent<HTMLInputElement>) => {\n        setNewPays(e.target.value);\n    }\n\n    const handleSubmitPays = (e: React.FormEvent<HTMLFormElement>) => {\n        e.preventDefault();\n        if(newPays.length < 2) {\n            setNewPays('');\n            setErrorMsgPays('No existe ese país !');\n            setTimeout(function(){ setErrorMsgPays('Elegí tu país'); }, 3000);\n            return;\n        }\n        var user = firebase.auth().currentUser;\n        if (user) {\n            firebase.firestore().collection('config').doc(user.uid).update({\n                pays: newPays\n            });\n            setEditPays(false);\n            setPays(newPays);\n        } else {\n            return;\n        }\n    }\n\n    const handleSubmitName = (e: React.FormEvent<HTMLFormElement>) => {\n        e.preventDefault();\n        if(name.length < 2) {\n            setName('');\n            setErrorMsg('Debe tener al menos 2 carácteres !');\n            setTimeout(function(){ setErrorMsg('Elegí un nombre'); }, 3000);\n            return;\n        }\n        firebase.firestore().collection('config').doc(userID).set({\n            username: name\n        });\n        setEditName(false);\n        setUsername(name);\n    }\n\n    const handleEditPhoto = () => {\n        document.getElementsByName('photo')[0].click()\n    }\n\n    const handleChangePhoto = (e: React.ChangeEvent<HTMLInputElement>) => {\n        var user = firebase.auth().currentUser;\n        setErrorMsgImg(undefined);\n        \n        if(e.target.files && user) {\n            var file = e.target.files[0];\n            if(file.type !== 'image/jpeg' && file.type !== 'image/png') {\n                setErrorMsgImg('Debe ser JPG o PNG !'); \n                return;\n            }\n            // tinify.fromFile(\"unoptimized.jpg\").toFile(\"optimized.jpg\"); \n            var ref = firebase.storage().ref().child('profilePicture/' + user.uid);\n            console.log(ref);\n            ref.put(file).then(function(result) {\n                ref.getDownloadURL().then((url) => {\n                    user?.updateProfile({\n                        photoURL: url\n                    });\n                    setProfilePicture(url);\n                });\n            });\n            /* ref.getDownloadURL().then((url) => {\n                user?.updateProfile({\n                    photoURL: url\n                });\n                task.on('state_changed', function(snapshot) {\n                    var percentage = (snapshot.bytesTransferred / snapshot.totalBytes) *100;\n                    if (percentage === 100) {console.log(url);setProfilePicture(url);}\n                });\n            }); */\n        } else {\n            return;\n        }\n    }\n\n    return (\n        <div className=\"configContainer\">\n            {\n                (username === null || editName === true) &&\n                <form className=\"signupForm\" onSubmit={(e) => {handleSubmitName(e)}}>\n                    <input name=\"username\" type=\"text\" autoComplete=\"off\" className=\"editNameInput\" placeholder={errorMsg} value={name} onChange={(e) => {handleChangeName(e)}} />\n                </form>\n            }\n            {\n                (username!== null && editName === false) &&\n                <h3 className=\"username\">{username}<div className=\"edit\" onClick={() => setEditName(true)}></div></h3>\n            }\n            <div className=\"profilePictureGrand\" style={{backgroundImage: `url(${profilePicture})`}}>\n                <div className=\"error\">{errorMsgImg}</div>\n                <div className=\"edit\" onClick={handleEditPhoto}>EDITAR</div>\n            </div>\n            <form className=\"signupForm\" style={{display: 'none'}}>\n                <input name=\"photo\" type=\"file\" onChange={(e) => {handleChangePhoto(e)}}/>\n            </form>\n            {\n                (uni === null || editUni === true) &&\n                <form className=\"signupForm\" onSubmit={(e) => {handleSubmitUni(e)}}>\n                    <input name=\"uni\" type=\"text\" autoComplete=\"off\" className=\"editNameInput\" placeholder={errorMsgUni} value={newUni} onChange={(e) => {handleChangeUni(e)}} />\n                </form>\n            }\n            {\n                (uni!== null && editUni === false) &&\n                <h3 className=\"username\">{uni}<div className=\"edit\" onClick={() => setEditUni(true)}></div></h3>\n            }\n\n            {\n                (pays === null || editPays === true) &&\n                <form className=\"signupForm\" onSubmit={(e) => {handleSubmitPays(e)}}>\n                    <input name=\"pays\" type=\"text\" autoComplete=\"off\" className=\"editNameInput\" placeholder={errorMsgPays} value={newPays} onChange={(e) => {handleChangePays(e)}} />\n                </form>\n            }\n            {\n                (pays!== null && editPays === false) &&\n                <h3 className=\"username\">{pays}<div className=\"edit\" onClick={() => setEditPays(true)}></div></h3>\n            }\n            <button onClick={signOut}>Desconectarse</button>\n        </div>\n    );\n}\n\nexport default Config;"]},"metadata":{},"sourceType":"module"}