{"ast":null,"code":"var _jsxFileName = \"/Users/xavier/Documents/De\\u0301veloppement/portarch/src/components/ajouter.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport firebase from '../firebase';\nimport Projet from './projet';\n\nconst Ajouter = ({\n  mesœuvres\n}) => {\n  var _firebase$auth$curren, _firebase$auth$curren2, _firebase$auth$curren3;\n\n  const [œuvre, setœuvre] = useState({\n    auteurID: (_firebase$auth$curren = firebase.auth().currentUser) === null || _firebase$auth$curren === void 0 ? void 0 : _firebase$auth$curren.uid,\n    auteur: (_firebase$auth$curren2 = firebase.auth().currentUser) === null || _firebase$auth$curren2 === void 0 ? void 0 : _firebase$auth$curren2.displayName,\n    photoAuteur: (_firebase$auth$curren3 = firebase.auth().currentUser) === null || _firebase$auth$curren3 === void 0 ? void 0 : _firebase$auth$curren3.photoURL,\n    titre: '',\n    photo: ''\n  });\n  const [percentage, setPercentage] = useState();\n  const [photoPrincipale, setPhotoPrincipale] = useState('https://firebasestorage.googleapis.com/v0/b/portarch-4f70e.appspot.com/o/œuvres-photos-principales%2Fgreece.png?alt=media&token=7ef93575-12c5-42c4-aff3-7467e18f019a');\n  const [agregado, setAgregado] = useState('AGREGAR');\n  useEffect(() => {\n    document.getElementsByClassName('lateral')[0].classList.add('ouvert');\n  }, []);\n  useEffect(() => {\n    const mainPictureForm = document.getElementsByClassName('mainPictureForm')[0];\n    setTimeout(function () {\n      let width = document.getElementsByClassName('lateral')[0].clientWidth;\n      mainPictureForm.style.height = width * 0.66 + \"px\";\n      mainPictureForm.style.width = width + \"px\";\n    }, 500);\n  }, []);\n\n  const handleChangeTitle = e => {\n    const newœuvre = { ...œuvre\n    };\n    newœuvre.titre = e.target.value;\n    setœuvre(newœuvre);\n  };\n\n  const handleEditPhoto = () => {\n    document.getElementsByName('photo')[0].click();\n  };\n\n  const handleChangePhoto = e => {\n    if (e.target.files) {\n      var file = e.target.files[0];\n      var ref = firebase.storage().ref('œuvres-photos-principales/' + file.name);\n      var task = ref.put(file);\n      task.on('state_changed', function (snapshot) {\n        var percentage = snapshot.bytesTransferred / snapshot.totalBytes * 100;\n        setPercentage(percentage);\n\n        if (percentage === 100) {\n          setTimeout(function () {\n            ref.getDownloadURL().then(url => {\n              setPhotoPrincipale(url);\n              const newœuvre = { ...œuvre\n              };\n              newœuvre.photo = url;\n              setœuvre(newœuvre);\n            });\n          }, 500);\n        }\n      });\n    } else {\n      return;\n    }\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    firebase.firestore().collection('œuvres').doc().set(œuvre);\n    const form = document.getElementsByClassName('addForm')[0];\n    const mainPic = document.getElementsByClassName(\"mainPictureForm\")[0];\n    setTimeout(function () {\n      form.reset();\n      form.classList.add('ferme');\n      setPercentage(undefined);\n      mainPic.style.backgroundImage = 'none';\n      setAgregado('AGREGADO !');\n    }, 500);\n    setTimeout(function () {\n      setAgregado('AGREGAR');\n      form.classList.remove('ferme');\n      mainPic.style.backgroundImage = 'url(\"https://firebasestorage.googleapis.com/v0/b/portarch-4f70e.appspot.com/o/œuvres-photos-principales%2Fgreece.png?alt=media&token=7ef93575-12c5-42c4-aff3-7467e18f019a\")';\n    }, 3000);\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"lateral ajouterContainer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }\n  }, \"MIS PROYECTOS\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\\u0153uvresContainer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }\n  }, mesœuvres.map(œuvre => /*#__PURE__*/React.createElement(Projet, {\n    key: œuvre.id,\n    titre: œuvre.titre,\n    photo: œuvre.photo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 48\n    }\n  })), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 17\n    }\n  }, agregado), /*#__PURE__*/React.createElement(\"form\", {\n    className: \"signupForm addForm\",\n    onSubmit: e => handleSubmit(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 21\n    }\n  }, \"T\\xEDtulo\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    onChange: e => handleChangeTitle(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 21\n    }\n  }, \"Foto principal \", percentage && Math.round(percentage) + \"%\"), /*#__PURE__*/React.createElement(\"input\", {\n    style: {\n      display: 'none'\n    },\n    name: \"photo\",\n    type: \"file\",\n    onChange: e => {\n      handleChangePhoto(e);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mainPictureForm\",\n    style: {\n      backgroundImage: `url(${photoPrincipale})`\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"edit\",\n    onClick: handleEditPhoto,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 107\n    }\n  }, \"EDITAR\")), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 21\n    }\n  }))));\n};\n\nexport default Ajouter;","map":{"version":3,"sources":["/Users/xavier/Documents/Développement/portarch/src/components/ajouter.tsx"],"names":["React","useState","useEffect","firebase","Projet","Ajouter","mesœuvres","œuvre","setœuvre","auteurID","auth","currentUser","uid","auteur","displayName","photoAuteur","photoURL","titre","photo","percentage","setPercentage","photoPrincipale","setPhotoPrincipale","agregado","setAgregado","document","getElementsByClassName","classList","add","mainPictureForm","setTimeout","width","clientWidth","style","height","handleChangeTitle","e","newœuvre","target","value","handleEditPhoto","getElementsByName","click","handleChangePhoto","files","file","ref","storage","name","task","put","on","snapshot","bytesTransferred","totalBytes","getDownloadURL","then","url","handleSubmit","preventDefault","firestore","collection","doc","set","form","mainPic","reset","undefined","backgroundImage","remove","map","id","Math","round","display"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport firebase from '../firebase';\nimport Projet from './projet';\n\ntype Props = {\n    mesœuvres: any\n}\n\nconst Ajouter: React.FC<Props> = ({ mesœuvres}) => {\n    const [œuvre, setœuvre] = useState({\n        auteurID: firebase.auth().currentUser?.uid,\n        auteur: firebase.auth().currentUser?.displayName,\n        photoAuteur: firebase.auth().currentUser?.photoURL,\n        titre: '',\n        photo: ''\n    });\n    const [percentage, setPercentage] = useState<number>();\n    const [photoPrincipale, setPhotoPrincipale] = useState<string>('https://firebasestorage.googleapis.com/v0/b/portarch-4f70e.appspot.com/o/œuvres-photos-principales%2Fgreece.png?alt=media&token=7ef93575-12c5-42c4-aff3-7467e18f019a');\n    const [agregado, setAgregado] = useState<string>('AGREGAR');\n\n    useEffect(() => {\n        document.getElementsByClassName('lateral')[0].classList.add('ouvert');\n    }, []);\n\n    useEffect(() => {\n        const mainPictureForm = document.getElementsByClassName('mainPictureForm')[0] as HTMLElement;\n        setTimeout(function(){ \n            let width = document.getElementsByClassName('lateral')[0].clientWidth;\n            mainPictureForm.style.height = width*0.66 + \"px\";\n            mainPictureForm.style.width = width + \"px\";  \n        }, 500);       \n    }, []);\n\n    const handleChangeTitle = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const newœuvre = {...œuvre};\n        newœuvre.titre = e.target.value;\n        setœuvre(newœuvre);\n    }\n\n    const handleEditPhoto = () => {\n        document.getElementsByName('photo')[0].click()\n    }\n\n    const handleChangePhoto = (e: React.ChangeEvent<HTMLInputElement>) => {        \n        if(e.target.files) {\n            var file = e.target.files[0];\n            var ref = firebase.storage().ref('œuvres-photos-principales/' + file.name);\n            var task = ref.put(file);\n            task.on('state_changed', function(snapshot) {\n                var percentage = (snapshot.bytesTransferred / snapshot.totalBytes) *100;\n                setPercentage(percentage);\n\n                if(percentage === 100) {\n                    setTimeout(function() {\n                        ref.getDownloadURL().then((url) => {\n                            setPhotoPrincipale(url);\n                            const newœuvre = {...œuvre};\n                            newœuvre.photo = url;\n                            setœuvre(newœuvre);\n                        });\n                    }, 500);\n                }\n            });\n        } else {\n            return;\n        }\n    }\n\n    const handleSubmit = (e: React.FormEvent<HTMLFormElement>) => {\n        e.preventDefault();\n        firebase.firestore().collection('œuvres').doc().set(œuvre);\n        const form = document.getElementsByClassName('addForm')[0] as HTMLFormElement;\n        const mainPic = document.getElementsByClassName(\"mainPictureForm\")[0] as HTMLElement;\n        setTimeout(function () {\n            form.reset();\n            form.classList.add('ferme');\n            setPercentage(undefined);\n            mainPic.style.backgroundImage = 'none';\n            setAgregado('AGREGADO !');\n        }, 500);\n        setTimeout(function () {\n            setAgregado('AGREGAR');\n            form.classList.remove('ferme');\n            mainPic.style.backgroundImage = 'url(\"https://firebasestorage.googleapis.com/v0/b/portarch-4f70e.appspot.com/o/œuvres-photos-principales%2Fgreece.png?alt=media&token=7ef93575-12c5-42c4-aff3-7467e18f019a\")';\n        }, 3000);\n    }\n\n    return (\n        <div className=\"lateral ajouterContainer\">\n            <h2>MIS PROYECTOS</h2>\n            <div className=\"œuvresContainer\">\n                {mesœuvres.map((œuvre: any) => <Projet key={œuvre.id} titre={œuvre.titre} photo={œuvre.photo}/>)}\n                <br />\n                <h3>{agregado}</h3>\n                <form className=\"signupForm addForm\" onSubmit={(e) => handleSubmit(e)} >\n                    <label>Título</label>\n                    <input type=\"text\" onChange={(e) => handleChangeTitle(e)} />\n                    <label>Foto principal {percentage && Math.round(percentage) + \"%\"}</label>\n                    <input style={{display: 'none'}} name=\"photo\" type=\"file\" onChange={(e) => {handleChangePhoto(e)}} />\n                    <div className=\"mainPictureForm\" style={{backgroundImage: `url(${photoPrincipale})`}}><div className=\"edit\" onClick={handleEditPhoto}>EDITAR</div></div>\n                    <input type=\"submit\" />\n                </form>\n            </div>\n        </div>\n    );\n}\n\nexport default Ajouter;"]},"metadata":{},"sourceType":"module"}