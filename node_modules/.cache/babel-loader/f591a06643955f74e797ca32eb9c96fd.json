{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst tinify_1 = require(\"../tinify\");\n\nconst compat_1 = require(\"./compat\");\n\nclass Source {\n  /** @internal */\n  constructor(url, commands) {\n    this._url = url;\n    this._commands = commands || {};\n  }\n\n  static fromFile(path) {\n    const location = compat_1.readFile(path).then(data => {\n      const response = tinify_1.default.client.request(\"post\", \"/shrink\", data);\n      return response.then(res => res.headers.location);\n    });\n    return new tinify_1.default.Source(location);\n  }\n\n  static fromBuffer(data) {\n    const response = tinify_1.default.client.request(\"post\", \"/shrink\", data);\n    const location = response.then(res => res.headers.location);\n    return new tinify_1.default.Source(location);\n  }\n\n  static fromUrl(url) {\n    const response = tinify_1.default.client.request(\"post\", \"/shrink\", {\n      source: {\n        url\n      }\n    });\n    const location = response.then(res => res.headers.location);\n    return new tinify_1.default.Source(location);\n  }\n\n  preserve(...options) {\n    if (Array.isArray(options[0])) options = options[0];\n    return new tinify_1.default.Source(this._url, Object.assign({\n      preserve: options\n    }, this._commands));\n  }\n\n  resize(options) {\n    return new tinify_1.default.Source(this._url, Object.assign({\n      resize: options\n    }, this._commands));\n  }\n\n  store(options) {\n    const commands = Object.assign({\n      store: options\n    }, this._commands);\n\n    const response = this._url.then(url => {\n      return tinify_1.default.client.request(\"post\", url, commands);\n    });\n\n    return new tinify_1.default.ResultMeta(response.then(res => res.headers));\n  }\n\n  result() {\n    const commands = this._commands;\n\n    const response = this._url.then(url => {\n      return tinify_1.default.client.request(\"get\", url, commands);\n    });\n\n    return new tinify_1.default.Result(response.then(res => res.headers), response.then(res => res.body));\n  }\n\n  toFile(path, callback) {\n    return this.result().toFile(path, callback);\n  }\n\n  toBuffer(callback) {\n    return this.result().toBuffer(callback);\n  }\n\n}\n\nexports.default = Source;","map":{"version":3,"sources":["/Users/xavier/Documents/Développement/portarch/node_modules/tinify/lib/tinify/Source.js"],"names":["Object","defineProperty","exports","value","tinify_1","require","compat_1","Source","constructor","url","commands","_url","_commands","fromFile","path","location","readFile","then","data","response","default","client","request","res","headers","fromBuffer","fromUrl","source","preserve","options","Array","isArray","assign","resize","store","ResultMeta","result","Result","body","toFile","callback","toBuffer"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst tinify_1 = require(\"../tinify\");\nconst compat_1 = require(\"./compat\");\nclass Source {\n    /** @internal */\n    constructor(url, commands) {\n        this._url = url;\n        this._commands = commands || {};\n    }\n    static fromFile(path) {\n        const location = compat_1.readFile(path).then(data => {\n            const response = tinify_1.default.client.request(\"post\", \"/shrink\", data);\n            return response.then(res => res.headers.location);\n        });\n        return new tinify_1.default.Source(location);\n    }\n    static fromBuffer(data) {\n        const response = tinify_1.default.client.request(\"post\", \"/shrink\", data);\n        const location = response.then(res => res.headers.location);\n        return new tinify_1.default.Source(location);\n    }\n    static fromUrl(url) {\n        const response = tinify_1.default.client.request(\"post\", \"/shrink\", { source: { url } });\n        const location = response.then(res => res.headers.location);\n        return new tinify_1.default.Source(location);\n    }\n    preserve(...options) {\n        if (Array.isArray(options[0]))\n            options = options[0];\n        return new tinify_1.default.Source(this._url, Object.assign({ preserve: options }, this._commands));\n    }\n    resize(options) {\n        return new tinify_1.default.Source(this._url, Object.assign({ resize: options }, this._commands));\n    }\n    store(options) {\n        const commands = Object.assign({ store: options }, this._commands);\n        const response = this._url.then(url => {\n            return tinify_1.default.client.request(\"post\", url, commands);\n        });\n        return new tinify_1.default.ResultMeta(response.then(res => res.headers));\n    }\n    result() {\n        const commands = this._commands;\n        const response = this._url.then(url => {\n            return tinify_1.default.client.request(\"get\", url, commands);\n        });\n        return new tinify_1.default.Result(response.then(res => res.headers), response.then(res => res.body));\n    }\n    toFile(path, callback) {\n        return this.result().toFile(path, callback);\n    }\n    toBuffer(callback) {\n        return this.result().toBuffer(callback);\n    }\n}\nexports.default = Source;\n"]},"metadata":{},"sourceType":"script"}