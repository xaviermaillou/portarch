{"ast":null,"code":"var _jsxFileName = \"/Users/xavier/Documents/De\\u0301veloppement/portarch/src/components/recherche.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport Tendance from './tendance';\nimport firebase from '../firebase';\n\nvar _ = require('lodash/array');\n\nfunction UseTendances() {\n  const [œuvres, setœuvres] = useState([]);\n  useEffect(() => {\n    firebase.firestore().collection('œuvres').orderBy('note', 'desc').limit(6).onSnapshot(snapshot => {\n      let position = 1;\n      const newœuvres = snapshot.docs.map(doc => ({\n        id: doc.id,\n        position: position++,\n        ...doc.data(),\n        photos: []\n      }));\n      setœuvres(newœuvres);\n    });\n  }, []);\n  return œuvres;\n}\n\nconst Recherche = () => {\n  const [isSearching, setIsSearching] = useState(false);\n  const [search, setSearch] = useState('');\n  const [resultats, setResultats] = useState([]);\n  const [resultatsAuteur, setResultatsAuteur] = useState([]);\n  const [resultatsTitre, setResultatsTitre] = useState([]);\n  const tendances = UseTendances();\n  useEffect(() => {\n    document.getElementsByClassName('lateral')[0].classList.add('ouvert');\n  }, []);\n\n  const handleChange = e => {\n    setSearch(e.target.value);\n  };\n\n  const handleSearch = e => {\n    e.preventDefault();\n    setIsSearching(true);\n    firebase.firestore().collection('œuvres').where('auteur', '>=', search.toLowerCase()).onSnapshot(snapshot => {\n      const newResultatsAuteur = snapshot.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      setResultatsAuteur(newResultatsAuteur);\n    });\n    firebase.firestore().collection('œuvres').where('titre', '>=', search.toLowerCase()).onSnapshot(snapshot => {\n      const newResultatsTitre = snapshot.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      setResultatsTitre(newResultatsTitre);\n    });\n  };\n\n  const newArray = _.concat(resultatsAuteur, resultatsTitre);\n\n  console.log(newArray);\n  console.log(_.uniqWith(newArray, _.isEqual));\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"lateral rechercheContainer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: e => handleSearch(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    value: search,\n    placeholder: \"Palabras claves...\",\n    onChange: e => handleChange(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 57\n    }\n  })), \"BUSCAR\"), !isSearching && /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 21\n    }\n  }, \"TENDENCIAS\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"tendancesContainer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 21\n    }\n  }, Object.keys(tendances).length === 0 && /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 65\n    }\n  }, /*#__PURE__*/React.createElement(Tendance, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 70\n    }\n  }), /*#__PURE__*/React.createElement(Tendance, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 82\n    }\n  }), /*#__PURE__*/React.createElement(Tendance, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 94\n    }\n  }), /*#__PURE__*/React.createElement(Tendance, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 106\n    }\n  }), /*#__PURE__*/React.createElement(Tendance, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 118\n    }\n  })), tendances.map(tendance => /*#__PURE__*/React.createElement(Tendance, {\n    key: tendance.id,\n    id: tendance.id,\n    position: tendance.position,\n    titre: tendance.titre,\n    photo: tendance.photo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 59\n    }\n  })))));\n};\n\nexport default Recherche;","map":{"version":3,"sources":["/Users/xavier/Documents/Développement/portarch/src/components/recherche.tsx"],"names":["React","useState","useEffect","Tendance","firebase","_","require","UseTendances","œuvres","setœuvres","firestore","collection","orderBy","limit","onSnapshot","snapshot","position","newœuvres","docs","map","doc","id","data","photos","Recherche","isSearching","setIsSearching","search","setSearch","resultats","setResultats","resultatsAuteur","setResultatsAuteur","resultatsTitre","setResultatsTitre","tendances","document","getElementsByClassName","classList","add","handleChange","e","target","value","handleSearch","preventDefault","where","toLowerCase","newResultatsAuteur","newResultatsTitre","newArray","concat","console","log","uniqWith","isEqual","Object","keys","length","tendance","titre","photo"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,QAAP,MAAqB,YAArB;AACA,OAAOC,QAAP,MAAqB,aAArB;;AACA,IAAIC,CAAC,GAAGC,OAAO,CAAC,cAAD,CAAf;;AAEA,SAASC,YAAT,GAAwB;AACpB,QAAM,CAACC,MAAD,EAASC,SAAT,IAAsBR,QAAQ,CAAM,EAAN,CAApC;AAEAC,EAAAA,SAAS,CAAC,MAAM;AACZE,IAAAA,QAAQ,CAACM,SAAT,GAAqBC,UAArB,CAAgC,QAAhC,EAA0CC,OAA1C,CAAkD,MAAlD,EAA0D,MAA1D,EAAkEC,KAAlE,CAAwE,CAAxE,EAA2EC,UAA3E,CAAuFC,QAAD,IAAc;AAChG,UAAIC,QAAQ,GAAG,CAAf;AACA,YAAMC,SAAS,GAAGF,QAAQ,CAACG,IAAT,CAAcC,GAAd,CAAmBC,GAAD,KAAU;AAC1CC,QAAAA,EAAE,EAAED,GAAG,CAACC,EADkC;AAE1CL,QAAAA,QAAQ,EAAEA,QAAQ,EAFwB;AAG1C,WAAGI,GAAG,CAACE,IAAJ,EAHuC;AAI1CC,QAAAA,MAAM,EAAE;AAJkC,OAAV,CAAlB,CAAlB;AAOAd,MAAAA,SAAS,CAACQ,SAAD,CAAT;AACH,KAVD;AAWH,GAZQ,EAYN,EAZM,CAAT;AAcA,SAAOT,MAAP;AACH;;AAED,MAAMgB,SAAmB,GAAG,MAAM;AAC9B,QAAM,CAACC,WAAD,EAAcC,cAAd,IAAgCzB,QAAQ,CAAU,KAAV,CAA9C;AACA,QAAM,CAAC0B,MAAD,EAASC,SAAT,IAAsB3B,QAAQ,CAAS,EAAT,CAApC;AACA,QAAM,CAAC4B,SAAD,EAAYC,YAAZ,IAA4B7B,QAAQ,CAAM,EAAN,CAA1C;AACA,QAAM,CAAC8B,eAAD,EAAkBC,kBAAlB,IAAwC/B,QAAQ,CAAM,EAAN,CAAtD;AACA,QAAM,CAACgC,cAAD,EAAiBC,iBAAjB,IAAsCjC,QAAQ,CAAM,EAAN,CAApD;AACA,QAAMkC,SAAS,GAAG5B,YAAY,EAA9B;AAEAL,EAAAA,SAAS,CAAC,MAAM;AACZkC,IAAAA,QAAQ,CAACC,sBAAT,CAAgC,SAAhC,EAA2C,CAA3C,EAA8CC,SAA9C,CAAwDC,GAAxD,CAA4D,QAA5D;AACH,GAFQ,EAEN,EAFM,CAAT;;AAIA,QAAMC,YAAY,GAAIC,CAAD,IAA4C;AAC7Db,IAAAA,SAAS,CAACa,CAAC,CAACC,MAAF,CAASC,KAAV,CAAT;AACH,GAFD;;AAIA,QAAMC,YAAY,GAAIH,CAAD,IAAyC;AAC1DA,IAAAA,CAAC,CAACI,cAAF;AACAnB,IAAAA,cAAc,CAAC,IAAD,CAAd;AAEAtB,IAAAA,QAAQ,CAACM,SAAT,GAAqBC,UAArB,CAAgC,QAAhC,EAA0CmC,KAA1C,CAAgD,QAAhD,EAA0D,IAA1D,EAAgEnB,MAAM,CAACoB,WAAP,EAAhE,EAAsFjC,UAAtF,CAAkGC,QAAD,IAAc;AAC3G,YAAMiC,kBAAkB,GAAGjC,QAAQ,CAACG,IAAT,CAAcC,GAAd,CAAmBC,GAAD,KAAU;AACnDC,QAAAA,EAAE,EAAED,GAAG,CAACC,EAD2C;AAEnD,WAAGD,GAAG,CAACE,IAAJ;AAFgD,OAAV,CAAlB,CAA3B;AAIAU,MAAAA,kBAAkB,CAACgB,kBAAD,CAAlB;AACH,KAND;AASA5C,IAAAA,QAAQ,CAACM,SAAT,GAAqBC,UAArB,CAAgC,QAAhC,EAA0CmC,KAA1C,CAAgD,OAAhD,EAAyD,IAAzD,EAA+DnB,MAAM,CAACoB,WAAP,EAA/D,EAAqFjC,UAArF,CAAiGC,QAAD,IAAc;AAC1G,YAAMkC,iBAAiB,GAAGlC,QAAQ,CAACG,IAAT,CAAcC,GAAd,CAAmBC,GAAD,KAAU;AAClDC,QAAAA,EAAE,EAAED,GAAG,CAACC,EAD0C;AAElD,WAAGD,GAAG,CAACE,IAAJ;AAF+C,OAAV,CAAlB,CAA1B;AAIAY,MAAAA,iBAAiB,CAACe,iBAAD,CAAjB;AACH,KAND;AAOH,GApBD;;AAsBA,QAAMC,QAAQ,GAAG7C,CAAC,CAAC8C,MAAF,CAASpB,eAAT,EAA0BE,cAA1B,CAAjB;;AACAmB,EAAAA,OAAO,CAACC,GAAR,CAAYH,QAAZ;AACAE,EAAAA,OAAO,CAACC,GAAR,CAAYhD,CAAC,CAACiD,QAAF,CAAWJ,QAAX,EAAqB7C,CAAC,CAACkD,OAAvB,CAAZ;AAEA,sBACI;AAAK,IAAA,SAAS,EAAC,4BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI;AAAM,IAAA,QAAQ,EAAGd,CAAD,IAAOG,YAAY,CAACH,CAAD,CAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAwC;AAAO,IAAA,IAAI,EAAC,MAAZ;AAAmB,IAAA,KAAK,EAAEd,MAA1B;AAAkC,IAAA,WAAW,EAAC,oBAA9C;AAAmE,IAAA,QAAQ,EAAGc,CAAD,IAAOD,YAAY,CAACC,CAAD,CAAhG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAxC,CADJ,WADJ,EAKK,CAAChB,WAAD,iBACG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI;AAAK,IAAA,SAAS,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACK+B,MAAM,CAACC,IAAP,CAAYtB,SAAZ,EAAuBuB,MAAvB,KAAkC,CAAlC,iBAAuC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAK,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAL,eAAiB,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAjB,eAA6B,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAA7B,eAAyC,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAzC,eAAqD,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAArD,CAD5C,EAEKvB,SAAS,CAAChB,GAAV,CAAewC,QAAD,iBAAmB,oBAAC,QAAD;AACE,IAAA,GAAG,EAAEA,QAAQ,CAACtC,EADhB;AAEE,IAAA,EAAE,EAAEsC,QAAQ,CAACtC,EAFf;AAGE,IAAA,QAAQ,EAAEsC,QAAQ,CAAC3C,QAHrB;AAIE,IAAA,KAAK,EAAE2C,QAAQ,CAACC,KAJlB;AAKE,IAAA,KAAK,EAAED,QAAQ,CAACE,KALlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAjC,CAFL,CAFJ,CANR,CADJ;AAuBH,CAjED;;AAmEA,eAAerC,SAAf","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Tendance from './tendance';\nimport firebase from '../firebase';\nvar _ = require('lodash/array');\n\nfunction UseTendances() {\n    const [œuvres, setœuvres] = useState<any>([]);\n\n    useEffect(() => {\n        firebase.firestore().collection('œuvres').orderBy('note', 'desc').limit(6).onSnapshot((snapshot) => {\n            let position = 1;\n            const newœuvres = snapshot.docs.map((doc) => ({\n                id: doc.id,\n                position: position++,\n                ...doc.data(),\n                photos: [] as any\n            }));\n    \n            setœuvres(newœuvres);\n        });\n    }, []);\n\n    return œuvres;\n}\n\nconst Recherche: React.FC = () => {\n    const [isSearching, setIsSearching] = useState<boolean>(false);\n    const [search, setSearch] = useState<string>('');\n    const [resultats, setResultats] = useState<any>([]);\n    const [resultatsAuteur, setResultatsAuteur] = useState<any>([]);\n    const [resultatsTitre, setResultatsTitre] = useState<any>([]);\n    const tendances = UseTendances();\n\n    useEffect(() => {\n        document.getElementsByClassName('lateral')[0].classList.add('ouvert');\n    }, []);\n\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        setSearch(e.target.value);\n    }\n\n    const handleSearch = (e: React.FormEvent<HTMLFormElement>) => {\n        e.preventDefault();\n        setIsSearching(true);\n\n        firebase.firestore().collection('œuvres').where('auteur', '>=', search.toLowerCase()).onSnapshot((snapshot) => {\n            const newResultatsAuteur = snapshot.docs.map((doc) => ({\n                id: doc.id,\n                ...doc.data()\n            }));\n            setResultatsAuteur(newResultatsAuteur);\n        });\n\n\n        firebase.firestore().collection('œuvres').where('titre', '>=', search.toLowerCase()).onSnapshot((snapshot) => {\n            const newResultatsTitre = snapshot.docs.map((doc) => ({\n                id: doc.id,\n                ...doc.data()\n            }));\n            setResultatsTitre(newResultatsTitre);\n        });\n    }\n\n    const newArray = _.concat(resultatsAuteur, resultatsTitre);\n    console.log(newArray);\n    console.log(_.uniqWith(newArray, _.isEqual));\n\n    return (\n        <div className=\"lateral rechercheContainer\">\n            <h2>\n                <form onSubmit={(e) => handleSearch(e)}><input type=\"text\" value={search} placeholder=\"Palabras claves...\" onChange={(e) => handleChange(e)} /></form>\n                BUSCAR\n            </h2>\n            {!isSearching &&\n                <div>\n                    <h3>TENDENCIAS</h3>\n                    <div className=\"tendancesContainer\">\n                        {Object.keys(tendances).length === 0 && <div><Tendance /><Tendance /><Tendance /><Tendance /><Tendance /></div>}\n                        {tendances.map((tendance: any) => <Tendance \n                                                            key={tendance.id} \n                                                            id={tendance.id}\n                                                            position={tendance.position} \n                                                            titre={tendance.titre} \n                                                            photo={tendance.photo} \n                                                        />)}\n                    </div>\n                </div>\n            }\n        </div>\n    );\n}\n\nexport default Recherche;"]},"metadata":{},"sourceType":"module"}